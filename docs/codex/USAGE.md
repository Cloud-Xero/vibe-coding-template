## Codex CLI 使い方ガイド

Codex CLI の実務向けワークフローをまとめました。最小の説明で「安全に・確実に」進めることを重視しています。

### クイックスタート

1) `codex` を起動し、案内に従ってサインイン/キー設定
2) リポジトリ直下で開始し、承認ポリシーを選択（推奨: バージョン管理下は自動許可 or 都度承認）
3) 取り組むタスクを短く伝える（例: 「`docs/codex` に使い方を追加」）

### 進め方（安全運用）

- **Preamble**（前置き 1–2 行）: これから何をするか宣言
- **Plan**（小さな段階に分割）: `update_plan` に相当する形で段階実行
- **Read → Propose → Apply**: 先に読み取り、差分を提案し、`apply_patch` で適用
- **Test/Build 最小化**: 変更範囲に限定して検証
- **Progress**: 数行の進捗報告で合意形成

### よく使う操作

- ファイル探索: `rg --files`, `rg <keyword>`
- 読み取り: `sed -n '1,200p' <path>`（200 行単位）
- 変更適用: `apply_patch`（パッチで明示的に差分を残す）
- 検証: 単体テストやビルドを必要最小限で実行

### 変更の原則

- 目的外の修正はしない（スタイル修正の巻き込み禁止）
- 既存の記法・ディレクトリ構成を尊重
- ドキュメントは隣接ファイルの調子と粒度を踏襲

### 失敗しにくい依頼の書き方

- 「対象」「目的」「完成条件」を 1 行で明示
- 読み取り先（パス）や参考（既存ファイル）を添える
- テスト/確認方法があれば一緒に提示

### 例: ドキュメント追加の流れ

1) 参考となる既存ドキュメントを読む
2) 新設先の構成を提案（ファイル名・見出し・粒度）
3) `apply_patch` でファイル追加
4) 必要ならリンクや目次（README）を同時に更新

### 注意点

- サンドボックスや承認モードにより、書き込み・ネットワーク・破壊的操作は制限される
- 長大ログや 1,000 行超の一括表示は避け、分割して読む
- 外部の設定・機密情報は書き込まず、参照のみ

### 補足

Codex CLI はスラッシュコマンドに依存せず、前置き（preamble）と計画（plan）、明示的なパッチ適用で再現性の高い変更を行います。

